<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

	<head lang="en">
		<meta charset="UTF-8">
		<title>优客书城首页</title>
		<link rel="stylesheet" type="text/css"  href="dist/css/bootstrap.min.css" th:href="@{/dist/css/bootstrap.min.css}">
		<link rel="stylesheet" type="text/css" href="css/index.css" th:href="@{/css/index.css}" />
		<link rel="stylesheet" type="text/css" href="css/animate.css" th:href="@{/css/animate.css}" />
	</head>
	<div>
		<!--导航部分  begin-->
		<!--<div th:replace="common/header :: header"></div>-->
		<div class="container" style="...">
			<div class="navbar-default well-sm" style="..." role="navigation">
				<div class="navbar-fluid">
					<button type="button" class="navbar-toggle" data-toggle="#example-navbar-collapse">
						<span class="sr-only">切换导航</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a class="navbar-brand" href="#">优客书城</a>
				</div>
				<ul class="collapse navbar-collapse" id="example-navbar-collapse">
					<li class="nav navbar-nav pull-left">
						<li class="active">
							<a href="index.html">首页</a>
						</li>
							<li class="dropdown">
						       <a href="#" class="dropdown-toggle" data-toggle="dropdown">
								   图书类型
								   <b class="caret"></b>
							   </a>
						<ul class="dropdown-menu">
							<li>
								<a href="books_list.html" th:href="@{/book/bookList(category=1)}">精选图书</a>
							</li>
							<li class="divider"></li>
							<li>
								<a href="books_list.html" th:href="@{/book/bookList(category=2)}">推荐图书</a>
							</li>
							<li>
								<a href="books_list.html" th:href="@{/book/bookList(category=3)}">特价图书</a>
							</li>
							<li class="divider"></li>
						</ul>
						</li>
					</li>
					<li th:if="${session.user == null}">
						<a href="#" data-toggle="modal" data-target="#loginModal">登录</a>
					</li>
					<li th:if="${session.user != null}">
						<a href="javascript:void(0)" th:text="${session.user.username}">用户名</a>
					</li>
					<li th:if="${session.user != null}">
						<a href="index.html" th:href="@{/user/logout}">安全退出</a>
					</li>
					<li th:if="${session.user == null}">
						<a href="#" data-toggle="modal" data-target="#register">注册</a>
					</li>
					<li>
						<a href="/book/order/list">我的订单</a>
					</li>
					<li>
						<a href="/book/cart/list"><span class="glyphicon glyphicon-shopping-cart"></span>我的购物车</a>
					</li>
				</ul>
				<div class="input-group col-md-3 pull-right" style="align-content: baseline">
					<input type="text" class="form-control" placeholder="请输入图书名"/>
					<span class="input-group-btn">
						<button class="btn btn-info btn-search">
							<span class="glyphicon glyphicon-search"></span>
						</button>
					</span>
				</div>
			</div>
		</div>
		</nav>
		</div>
		<!--导航部分 end-->

		<!--最顶端轮播图片 begin-->
		<!--<div th:replace="common/carousel :: carousel"></div>-->
		<div id="gcarouse" class="container">
			<!--轮播指标-->
			<ol class="carousel-indicators">
				<li data-target="#myCarousel" data-slide-to="0" class="active"></li>
				<li data-target="#myCarousel" data-slide-to="1"></li>
				<li data-target="#myCarousel" data-slide-to="2"></li>
			</ol>
			<!--轮播项目-->
			<div class="carousel-inner">
				<div class="item active">
					<a href="details.html"><img src="images/advert1.jpg" th:src="@{/images/advert1.jpg}" class="pull-left" alt="First slide"></a>
				</div>
				<div class="item">
					<a href="details.html"><img src="images/advert2.jpg" th:src="@{/images/advert2.jpg}"class="pull-left" alt="First slide"></a>
				</div>
				<div class="item">
					<a href="details.html"><img src="images/advert3.jpg" th:src="@{/images/advert3.jpg}"class="pull-left" alt="First slide"></a>
				</div>
			</div>
			<!--轮播导航-->
			<a class="carousel-control left"href="#myCarousel" data-slide="prev">&lsaquo;</a>
			<a class="carousel-control right"href="#myCarousel" data-slide="next">&rsaquo;</a>
		</div>
		<!--最顶端轮播图片 end-->

		<!--图书内容部分 begin-->
		<div class="container">
			<!--精选图书 begin-->
			<div>
				<div class="text-primary"><img src="images/bullet1.gif" th:src="@{/images/bullet1.gif}" alt="" title="">
					<a href="#">精选图书</a>
				</div>
				<!--加载数据-->
				<div id="selected"></div>
			</div>
			<!--精选图书 end-->

			<!--推荐图书 begin-->
			<div>
				<div class="text-primary"><img src="images/bullet1.gif" th:src="@{/images/bullet1.gif}" alt="" title="">
					<a href="#">推荐图书</a>
				</div>
				<!--加载数据-->
				<div id="recommend"></div>
			</div>
			<!--推荐图书end..-->

			<!--特价图书 begin-->
			<div>
				<div class="text-primary"><img src="images/bullet1.gif" th:src="@{/images/bullet1.gif}" alt="" title="">
					<a href="#">特价图书</a>
				</div>
				<!--加载数据-->
				<div id="bargain"></div>
			</div>
			<!--特价图书 end-->
			<hr>
			<!--首页底部信息 begin-->
		    <div class="container">
			    <div class="row">
				    <div class="col-md-offset-2 col-md-8">
					    <div class="row">
						    <div class="col-md-offset-2 col-md-2">
								<img src="images/logo.png">
						    </div>
							<div class="col-md-6" style="align-content: baseline">
								<div class="row">
									<div class="col-md-offset-2 col-md-10">
										<a href="http://www.gem-inno.com/">苏州高博应储信息科技有限公司&copy;所有</a>
									</div>
								</div>
								<div class="gap"></div>
					            <div class="row">
									<div class="col-md-offset-2 col-ma-10">
							            <span class="text-info">高博教育@|&nbsp;</span>
										<span class="text-info"><a href="http://www.xmgc360.com">项目工厂</a>|&nbsp;</span>
										<span class="text-info">2012-2020</span>
									</div>
						        </div>
					        </div>
				        </div>
			        </div>
		        </div>
            </div>
        </div>
		<!--首页底部信息end->
		<!-图书内容部分end-->

		<!-- 登录模态框（Modal） -->
        <div class="modal fade" id="loginModal" tabindex="-1" role="dialog" aria-labelledby="loginModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
					&times;
				</button>
						<h4 class="modal-title" id="loginModalLabel">
					用户登录
				</h4>
					</div>
					<div class="modal-body">
						<!--登录的form表单-->
						<form id="loginForm" class="form-horizontal" role="form" action="">
							<div class="form-group has-feedback">
								<label class="col-sm-2 control-label">用户名</label>
								<div class="col-sm-5">
									<input type="text" class="form-control" name="username" placeholder="请输入用户名">
									<span class="glyphicon glyphicon-user form-control-feedback"></span>
								</div>
								<div class="col-sm-3" id="userTip" style="padding-top: 10px;display: none">
									<label class="alert-danger">用户名不存在</label>
								</div>
							</div>
							<div class="form-group has-feedback">
								<label class="col-sm-2 control-label">密码</label>
								<div class="col-sm-5">
									<input type="password" class="form-control" name="password" placeholder="请输入密码">
									<span class="glyphicon glyphicon-lock form-control-feedback"></span>
								</div>
								<div class="col-sm-3" id="pwdTip" style="padding-top: 10px;display: none">
									<label class="alert-danger">密码不正确</label>
								</div>
							</div>
								<div class="form-group">
									<div class="col-sm-offset-2 col-sm-10">
										<div class="checkbox">
											<label>
												<input type="checkbox">请记住我
											</label>
										</div>
									</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
									<input type="submit" class="btn btn-primary" value="登录" th:onclick="|login()|">
								</div>
						</form>
					</div>
				</div>
			</div>
        </div>
        <!--登录modal end/modal-->
		<div class="modal fade" id="register" tabindex="-1" role="dialog" aria-labelledby="reModalLabel" aria-hidden="true">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                    &times;
					</button>
							<h4 class="modal-title" id="reModalLabel">
						用户注册
					</h4>
					    </div>
				        <div class="modal-body">
					    <!--登录的form表单-->
					    <form id="regForm" action="/book/user/register" method="post" class="form-horizontal" role="form">
						    <div class="form-group has-feedback">
							<label  class="col-sm-2 control-label">用户名</label>
							<div class="col-sm-5">
								<input type="text" name="username" class="form-control" required placeholder="小写字母开头，不写中文" th:onblur="|checkUser(this)|">
								<span class="glyphicon glyphicon-user form-control-feedback"></span>
							</div>
							<div id="msg" class="col-sm-3" style="padding-top: 10px; display: none">
								<label class="alert-danger" id="tip">用户名不合法</label>
							</div>
						</div>
						<div class="form-group has-feedback">
							<label  class="col-sm-2 control-label">密码</label>
							<div class="col-sm-5">
								<input type="password" name="password" class="form-control" placeholder="密码长度6-8位" minlength="6" maxlength="12">
								<span class="glyphicon glyphion-lock form-control-feedback"></span>
							</div>



						</div>
					<div class="form-group has-feedback">
						<label class="col-sm-2 control-label">确认密码</label>
						<div class="col-sm-5">
							<input type="password" class="form-control" minlength="6" maxlength="8" placeholder="lala">
							<span class="glyphicon glyphicon-lock form-control-feedback"></span>
						</div>
					</div>

					<div class="form-group has-feedback">
						<label class="col-sm-2 control-label">邮箱</label>
						<div class="col-sm-5">
							<input type="email" name="email" class="form-control" placeholder="合法邮箱格式">
							<span class="glyphicon glyphicon-envelope form-control-feedback"></span>
						</div>
					</div>

					<div class="form-group has-feedback">
						<label class="col-sm-2 control-label">电话</label>
						<div class="col-sm-5">
							<input type="tel" name="phone" class="form-control" placeholder="合法手机格式">
							<span class="glyphicon glyphicon-earphone form-control-feedback"></span>
						</div>
					</div>

					<div class="form-group has-feedback">
						<label class="col-sm-2 control-label">公司</label>
						<div class="col-sm-5">
							<input type="text" name="company" class="form-control" placeholder="请输入公司地址">
							<span class="glyphicon glyphicon-home form-control-feedback"></span>
						</div>
					</div>

					<div class="form-group has-feedback">
						<label class="col-sm-2 control-label">地址</label>
						<div class="col-sm-5">
							<input type="text" class="form-control" placeholder="请输入收货">
							<span class="glyphicon glyphicon-home form-control-feedback"></span>
						</div>
					</div>

					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
						<input type="button" class="btn btn-primary" value="注册" th:onclick="|register()|">
					</div>
				   </form>
					<!--form结束-->
				</div>
			</div>
			<!--/.modal-content-->
		</div>
	</div>


		<script src="dist/js/jquery.min.js" th:src="@{/dist/js/jquery.min.js}"></script>
		<script src="js/carousel.js" th:src="@{/js/carousel.js}" type="text/javascript" charset="utf-8"></script>
		<script src="dist/js/bootstrap.min.js" th:src="@{/dist/js/bootstrap.min.js}"></script>
		<script src="js/wow.js" th:src="@{/js/wow.js}"></script>
		<script th:inline="javascript">
			//获取应用路径
			var contextPath = [[${#request.getContextPath()}]];
		</script>
		<script type="text/javascript">
			if(!(/msie [6|7|8|9]/i.test(navigator.userAgent))) {
				new WOW().init();
			};
			$(function () {
				$("#selected").load(contextPath + "/book/getBookData",buildQuery(1,1));
				$("#recommend").load(contextPath + "/book/getBookData",buildQuery(1,2));
				$("#bargain").load(contextPath + "/book/getBookData",buildQuery(1,3));
            })

			//加载其他页数据
			function loadData(page,category) {
			    var node;
			    if(category == 1){
			        node = "selected";
				} else if(category == 2) {
			        node = "recommend";
				}else {
                    node = "bargain";
				}
                $("#" + node).load(contextPath + "/book/getBookData",buildQuery(page,category));
            }

            //包装查询参数
			function buildQuery(page,category) {
				var query = {};
				query.page = typeof page == "undefined" ? 1 : page;
				query.category = category;
				return query;
            }
            //验证用户名是否已经存在
			function checkUser(obj){
				$.ajax({
					url:contextPath + "/user/checkUserName",
					data:{"username":obj.value},
					method:"post",
					success:function (data) {
						if(data == 102 ){//用户存在
							$("#msg").css({
								"display" : "inline-block"
							});
							$("#msg").html("用户名不合法");
							$("#msg").removeClass("atler-success");
							$("#msg").addClass("alert-danger");
						}else{
							$("#msg").css({
								"display" : "inline-block"
							});
							$("#msg").html("用户名可以注册");
							$("#msg").removeClass("alert-danger");
							$("#msg").addClass("alert-success");
						}
					}
				})
			}
			//用户注册
			function register() {
				var datas = $("#regForm").serialize();
				$.ajax({
					url:contextPath + "/user/register",
					data:datas,
					method:"post",
					success:function (data) {
						if(data == 'success'){
							alert("注册成功，请登录！");
							$("#register").modal('hide');
						}
					}
				})
			}
			//用户登录
			function login() {
				var datas = $("#loginForm").serialize();
				$.ajax({
					url:contextPath + "/user/login",
					data:datas,
					method:"post",
					success:function (data) {
						$("#userTip").css("display","none");
						$("#pwdTip").css("display","none");
						if(data == 100){
							$("#loginModal").modal('hide');
							window.location.href = contextPath;
						}else if(data == 101){
							$("#userTip").css("display","block");
						}else{
							$("#pwdTip").css("display","block");
						}
					}
				})
			}
		</script>
	</body>
</html>